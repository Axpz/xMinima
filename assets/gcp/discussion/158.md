# GCP WebSocket 会话亲和性讨论（翻译整理）

---

### 高票回答（Highly Voted）

#### AWS56（4 年 10 个月前）
> 我同意 C。  
> 👍 16 次赞

#### tartar（4 年 2 个月前）
> C 没问题。  
> 👍 8 次赞

#### [已删除]（2 年 12 个月前）
> 来自上述链接的关键语句：
>
> WebSockets 的会话亲和性与其他请求相同。详情请查看会话亲和性（Session affinity）。  
> 👍 4 次赞

#### fraloca（3 年 9 个月前）
> https://cloud.google.com/load-balancing/docs/https#websocket_support  
> 👍 6 次赞

#### lynx256（3 年 6 个月前）
> 我认为 C 没问题。  
> 除了上面提到的 A、B 和 D 错误的理由，还有：
>
> A 和 D 是错误的，因为它们是关于更改应用程序 —— 而题目中写的是“你想帮助他确保他的应用程序能在 GCP 上正常运行”（并非重新设计/更改）。
>
> B 是错误的，因为你不需要“与安全团队一起审查 WebSocket 连接的加密要求”……  
> 👍 7 次赞

#### ashrafh（1 年 10 个月前）
> 谢谢  
> 👍 1 次赞

---

### 最新回答（Most Recent）

#### ryaryarya（3 个月前）
> 选项：D  
> 正确答案是 D。  
> 作为架构师，我们的工作是帮助设计可扩展且具备弹性的系统。如果会话数据绑定在一个服务器上，这个服务器一旦宕机，所有用户的会话就会丢失。这种方式也无法扩展。如今没有优秀的开发者还在构建依赖粘性会话的应用了。  
> 👍 1 次赞

#### plumbig11（3 个月前）
> 选项：C  
> 与云运维团队和工程师会面，讨论负载均衡器选项。  
> 👍 1 次赞

---

### 其他参与者意见

#### e5019c6（9 个月 2 周前）
> 选项：D  
> 我认为既然应用还处于设计阶段，完全可以更改其设计以更好地适配云环境。虽然 WebSockets 和 HTTP 会话是支持的，但它们不是云中应用的最佳选择。
>
> 有用户认为问题要求的是“帮助确保他的应用程序能在 GCP 上运行”，因此不应该更改。但我不这么认为。作为架构师，我们应审查开发者和工程师引入到组织架构中的所有设计。  
> 👍 3 次赞

#### examch（1 年 9 个月前）
> 选项：C  
> C 是正确答案。
>
> Google Cloud 的 HTTP(S) 负载均衡器在使用 HTTP 或 HTTPS 作为后端协议时，原生支持 WebSocket 协议。无需额外配置即可代理 WebSocket 连接。  
> 👍 3 次赞

#### NodummyIQ（1 年 9 个月前）
> 答案是 D。C 并不是最佳答案，因为它没有解决 WebSocket 和 HTTP 会话未在各个 Web 服务器之间分布的问题。
>
> 虽然负载均衡选项可能与整个应用程序的运行有关，但并未解决确保 WebSocket 和 HTTP 会话正确分布的具体问题。
>
> 更好的解决方案是帮助工程师重新设计应用程序，使用不依赖 WebSocket 和 HTTP 会话的分布式用户会话服务。或者工程师可以考虑将其 WebSocket 代码转换为 HTTP 流，以帮助实现会话分布。  
> 👍 1 次赞

#### e5019c6（9 个月 2 周前）
> 完全同意。但你没有投票去改变 C 的霸权 :P  
> 👍 1 次赞

#### AzureDP900（1 年 12 个月前）
> C 没问题。  
> 👍 2 次赞

#### ijazahmad722（2 年 1 个月前）
> 选项：C  
> 我同意 C。  
> 👍 2 次赞

#### vincy2202（2 年 10 个月前）
> 选项：C  
> C 是正确答案。  
> 👍 2 次赞

#### joe2211（2 年 10 个月前）
> 选项：C  
> 投票给 C。  
> 👍 4 次赞

---

### 相关延伸问题 - TerramEarth 案例研究

> 你正在为 TerramEarth 构建一个基于微服务的应用程序。该应用程序基于 Docker 容器。你希望遵循 Google 推荐的最佳实践，持续构建应用程序并存储构建产物。你应该怎么做？
  
选项如下：

- **A)** 在 Cloud Build 中配置源代码变更的触发器。调用 Cloud Build 为每个微服务构建容器镜像，并使用代码提交哈希进行标记。将镜像推送到 Container Registry。
- **B)** 在 Cloud Build 中配置源代码变更的触发器。该触发器调用构建作业，为微服务构建容器镜像。使用版本号进行标记，并将镜像推送到 Cloud Storage。
- **C)** 创建一个调度程序作业，每分钟检查一次代码库。如有变更，调用 Cloud Build 构建微服务的容器镜像。使用当前时间戳进行标记，并将镜像推送到 Container Registry。
- **D)** 在 Cloud Build 中配置源代码变更的触发器。调用 Cloud Build 构建一个容器镜像，使用标签 "latest" 进行标记，并将镜像推送到 Container Registry。

#### AzureDP900（1 年 12 个月前）
> A 看起来不错。  
> 👍 2 次赞

#### nickojul（3 年 1 个月前）
> A 没问题。  
> 👍 5 次赞

---

### 关于选项 D 的进一步讨论

#### DreamerK（3 年 2 个月前）
> D 之所以错误，是因为它的表述是“并不依赖于”，这意味着应用程序需要使用除 HTTP 或 WebSocket 之外的协议。
>
> 这不现实，且需要对应用程序进行大量重构。实际上，即使使用 HTTP 或 WebSocket，只要会话信息存储在所有 Web 服务器可访问的共享存储（如 NoSQL 数据库或 Redis）中，也是可以实现分布式会话服务的。
>
> 从这个角度看，D 是错误的。  
> 👍 1 次赞

#### e5019c6（9 个月 2 周前）
> 不需要重构，因为应用仍处于设计阶段。请认真阅读问题：
> “一位首席软件工程师告诉你，他的新应用设计……”  
> 👍 1 次赞

---

### 其他讨论

#### AnilKr（3 年 2 个月前）
> C 没问题。全球 HTTP(S) 负载均衡器支持 WebSockets。  
> 👍 1 次赞

#### kopper2019（3 年 2 个月前）
> 各位，2021 年 7 月 12 日有新问题发布，共 21 个问题，见第 152 题。  
> 👍 3 次赞

#### samsonakala（5 天 21 小时前）
> 你的意思是 21 个新问题都在第 152 题？  
> 👍 1 次赞

#### giovy_82（3 年 2 个月前）
> 我也同意 C。D 可能也可以，但题目中说“他的新应用设计”，说明应用才刚刚开发和部署，没必要从头重新设计来避免使用会话和 WebSocket。  
> 👍 1 次赞

#### ashrafh（1 年 10 个月前）
> 你从哪看到“新”这个词的？哈哈  
> 👍 1 次赞

#### e5019c6（9 个月 2 周前）
> 来自问题内容，第九个词。
> 而且，“设计”这个词很关键。它表示应用还没有构建。如果它说的是“他的新应用”，就不是这个意思
