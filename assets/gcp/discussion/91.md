# GCP VPC 防火墙规则相关讨论整理（中文翻译）

---

> **wk - 高赞，发表于 4 年零 11 个月前**  
> 应该是 A，因为没有“默认拒绝 egress（出口）”规则，只有“默认允许 egress”。
  
来源: [GCP 防火墙规则官方文档](https://cloud.google.com/vpc/docs/firewalls#default_firewall_rules)
  
每个 VPC 网络都有两个隐式防火墙规则。这些规则实际存在，但不会在 Cloud Console 中显示：

- **隐式允许出口规则（Implied allow egress rule）**：该出口规则的操作是允许（allow），目标是 0.0.0.0/0，优先级为最低（65535），允许任何实例向任何目标发送流量，除非被 GCP 阻止。若无其他更高优先级规则拒绝流量，且实例拥有外部 IP 或使用 NAT 实例，则允许访问互联网。详细要求可参考 [互联网访问要求](https://cloud.google.com/vpc/docs/firewalls#internet-access)。

- **隐式拒绝入口规则（Implied deny ingress rule）**：该入口规则的操作是拒绝（deny），源地址为 0.0.0.0/0，优先级为最低（65535），通过阻止所有传入流量保护实例。但默认网络中包含一些额外规则，允许某些类型的流量覆盖该规则。

👍 赞数：93

---

> **nitinz - 3 年零 7 个月前**  
> 正确答案是 A，其他选项都不合理。如果你认为是其他选项，那请回去重新了解防火墙规则。说真的，你还没准备好参加这个考试。  
👍 赞数：2

---

> **zr79 - 1 年零 11 个月前**  
> 谢谢你。  
👍 赞数：1

---

> **kumarp6 - 3 年零 11 个月前**  
> 正确答案是 B...  
👍 赞数：2

---

> **p4 - 3 年零 10 个月前**  
> 引用某本书内容：
>
> “防火墙规则通过阻止或允许网络流量控制进入（ingress）或流出（egress）网络的流量。VPC 默认定义了两个隐式防火墙规则：一个阻止所有传入流量，另一个允许所有流出流量。你可以通过定义优先级更高的防火墙规则改变这一行为。
> 防火墙规则的优先级是一个介于 0 到 65535 之间的整数，0 表示最高优先级，65535 表示最低优先级。”
👍 赞数：13

---

> **SSS987 - 8 个月零 3 周前**  
> 总结得好，很简洁明了！  
👍 赞数：1

---

> **MeasService - 高赞，发表于 4 年零 11 个月前**  
> 同意，正确答案是 A。没有“隐式拒绝 egress”规则，只有“隐式拒绝 ingress”规则。  
👍 赞数：10

---

> **MyPractice - 4 年零 9 个月前**  
> 同意 A。只有“隐式允许 egress 规则”或“隐式拒绝 ingress 规则”。
> 并没有“隐式拒绝 egress 规则”，这排除了选项 C 和 D。  
👍 赞数：3

---

> **ManishKS - 最近，发表于 1 年零 2 个月前**  
> B：为所有实例创建优先级为 100 的 egress 规则，拒绝所有流量。
> 然后再创建一个优先级为 1000 的 egress 规则，允许所有实例的 Active Directory 流量。
>
> 这个选项创建了一个低优先级的“允许”规则在后，一个高优先级的“拒绝”规则在前。
> 这种设置可以如预期那样工作：Active Directory 的流量会被允许，其他所有出口流量都会被阻止。  
👍 赞数：2

---

> **Emmarof - 1 年零 6 个月前**  
> 正确答案是 A。
>
> 解释：
> 为了实现所有 VPC 中的 Compute Engine 实例都可以通过特定端口连接到 Active Directory 服务器，同时阻止其他任何流量，应创建以下两个 egress 规则：
>
> - 创建一个优先级为 1000 的 egress 规则，拒绝所有实例的所有流量；
> - 创建另一个优先级为 100 的 egress 规则，允许所有实例访问 Active Directory 的流量；
>
> 在这个配置中，允许 AD 流量的规则优先级更高（数字更小），因此会先被评估。  
👍 赞数：2

---

> **Deb2293 - 1 年零 7 个月前**  
> 已选择答案：A  
> 应该是 A。  
> D 是错误的，因为隐式允许 egress 规则允许所有流量出站（目标为 0.0.0.0/0）。  
> 其优先级为最低（65535）。  
> 隐式拒绝 ingress 规则阻止所有传入连接。  
👍 赞数：1

---

> **8d31d36 - 1 年零 7 个月前**  
> 正确答案是 B。
>
> 为了让所有实例只能访问 Active Directory 的特定端口，同时阻止其他出口流量，应创建一个高优先级（数字小）的 egress 规则拒绝所有流量，
> 然后再创建一个低优先级（数字大）的 egress 规则，允许访问 Active Directory 服务器的流量。
>
> 选项 B 就是这样设置的：优先级 100 的拒绝规则先评估，之后是优先级 1000 的允许规则。  
👍 赞数：1

---

> **megumin - 1 年零 11 个月前**  
> 已选择答案：A  
> A 是 OK 的。  
👍 赞数：1

---

> **AzureDP900 - 1 年零 11 个月前**  
> 这是个非常直接的问题。
> 在这种情况下，应先用较高优先级（数字小）的规则允许流量，然后用较低优先级（数字大）的规则拒绝流量。
> 所以 A 是正确答案。  
👍 赞数：2

---

> **DrishaS4 - 2 年零 2 个月前**  
> 已选择答案：A  
> 参考：https://cloud.google.com/vpc/docs/firewalls#priority_order_for_firewall_rules  
👍 赞数：1

---

> **mv2000 - 2 年零 3 个月前**  
> 这是 2022 年 6 月 30 日的考试题。  
👍 赞数：6

---

> **moiradavis - 2 年零 2 个月前**  
> 哦，真的吗？我两年前考试也遇到这个问题，没想到现在考试里还在考这种题。  
👍 赞数：1

---

> **Baumster - 2 年零 7 个月前**  
> OT：为什么没有办法标记问题以便之后复习或重复练习？  
👍 赞数：1

---

> **haroldbenites - 2 年零 10 个月前**  
> 选择 A。  
> 当优先级较高时，egress 规则更受限；  
> 当优先级较高时，ingress 规则更开放。  
👍 赞数：1

---

> **vincy2202 - 2 年零 10 个月前**  
> 已选择答案：A  
> A 是正确答案。  
👍 赞数：1

---

> **vchrist - 2 年零 10 个月前**  
> 已选择答案：A  
> 了解防火墙规则的优先级顺序请参考：  
> https://cloud.google.com/vpc/docs/firewalls#priority_order_for_firewall_rules  
👍 赞数：1

---

> **nqthien041292 - 2 年零 10 个月前**  
> 已选择答案：A  
> 投票支持 A。  
👍 赞数：1

---

> **MaxNRG - 2 年零 11 个月前**  
> A - 创建优先级为 1000 的 egress 规则，拒绝所有实例的所有流量；
> 然后再创建优先级为 100 的 egress 规则，允许 Active Directory 流量。
>
> 默认防火墙规则（即隐式规则）如下：
> 1. egress（出口）允许所有 IP/端口；
> 2. ingress（入口）完全禁用；
>
> 这两条规则的优先级都是最低的（65535），无法移除。  
> 来源：[GCP 防火墙默认规则文档](https://cloud.google.com/vpc/docs/firewalls#default_firewall_rules)  
👍 赞数：2

---

> **victory108 - 3 年零 4 个月前**  
> A：为所有实例创建一个优先级为 1000 的 egress 规则，拒绝所有流量；
> 然后创建一个优先级为 100 的 egress 规则，允许 Active Directory 的流量。  
👍 赞数：2

---
